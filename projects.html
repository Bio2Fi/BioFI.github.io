<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>projects – BioFI</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./assets/images/BioFi-logo_sat.jpg" rel="icon" type="image/jpeg">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">BioFI</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./team.html"> 
<span class="menu-text">Team</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./projects.html" aria-current="page"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./publications.html"> 
<span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./software.html"> 
<span class="menu-text">Software</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./data.html"> 
<span class="menu-text">Data</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Bio2FI"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#projects" id="toc-projects" class="nav-link active" data-scroll-target="#projects">Projects</a>
  <ul class="collapse">
  <li><a href="#global-change-impacts-on-amazonian-biodiversity" id="toc-global-change-impacts-on-amazonian-biodiversity" class="nav-link" data-scroll-target="#global-change-impacts-on-amazonian-biodiversity">Global Change Impacts on Amazonian Biodiversity</a></li>
  <li><a href="#cascading-hazards-in-australia" id="toc-cascading-hazards-in-australia" class="nav-link" data-scroll-target="#cascading-hazards-in-australia">Cascading Hazards in Australia</a></li>
  <li><a href="#understanding-emerging-hazards" id="toc-understanding-emerging-hazards" class="nav-link" data-scroll-target="#understanding-emerging-hazards">Understanding Emerging Hazards</a></li>
  <li><a href="#quantification-of-future-drought-risk-at-global-scale" id="toc-quantification-of-future-drought-risk-at-global-scale" class="nav-link" data-scroll-target="#quantification-of-future-drought-risk-at-global-scale">Quantification of future drought risk at global scale</a></li>
  <li><a href="#global-forest-structure" id="toc-global-forest-structure" class="nav-link" data-scroll-target="#global-forest-structure">Global Forest Structure</a></li>
  <li><a href="#colorado-climate-change" id="toc-colorado-climate-change" class="nav-link" data-scroll-target="#colorado-climate-change">Colorado Climate Change</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">




<section id="projects" class="level1">
<h1>Projects</h1>
<section id="global-change-impacts-on-amazonian-biodiversity" class="level3">
<h3 class="anchored" data-anchor-id="global-change-impacts-on-amazonian-biodiversity">Global Change Impacts on Amazonian Biodiversity</h3>
<p>As part of our objective to provide rapid assessments of ecological disasters and forecast their impacts, we have assessed the catastrophic and widespread fires in the Amazon in 2019. We assessed how fire losses and the species they impact have changed over the past two decades based on high resolution remote sensing data.</p>
<p><img src="https://github.com/Bio2Fi/bio2fi.github.io/blob/main/assets/images/Feng_et_al_Fig2.jpg?raw=true" align="left" alt="Fires" width="700" img="" style="padding: 0px 10px 0px 0px;"></p>
<p><em>Above: Cumulative effects of fire on biodiversity in the Amazon rainforest. Curves depict cumulative numbers of plant (A) and vertebrate (C) species impacted by fire since 2001 (hollow symbols represent the results based on simulated fire data). Solid lines indicate total impact across the Amazon Basin, while dotted lines represent the impact confined to Brazil. Correlations between the cumulative area impacted by fire and cumulative number of plant (B) and vertebrate (D) species in the entire forest are depicted with a 95% confidence interval (p values &lt; 0.001). Silhouettes are courtesy of LeonardoG (photography) and T. Michael Keesey (vectorization) under a CC BY-SA 3.0 license (https://creativecommons.org/licenses/by-sa/3.0/).</em></p>
<hr>
</section>
<section id="cascading-hazards-in-australia" class="level3">
<h3 class="anchored" data-anchor-id="cascading-hazards-in-australia">Cascading Hazards in Australia</h3>
<p>We studied the impacts of drought and fire on all plant species in Australia during the record breaking 2019-20 fires. This work is ongoing but is notable because we have leveraged a collaboration with the lead of the Australian assessment team, <a href="https://researchers.mq.edu.au/en/persons/rachael-gallagher">Rachael Gallagher</a>, to use our work to guide prioritization of management and monitoring and recovery efforts post-fire. This has resulted in a ‘white paper’ report to the Australian government and will guide funding initiatives to advance monitoring of high-risk species.</p>
<p>To better understand how a series of ‘cascading environmental hazards’ may work in concert to alter vegetation dynamics in Australia, we are working on two projects that will help to understand and then forecast vegetation dynamics post fire. In the first, we are examining how post-fire biomass recovery is influenced by post-fire floods that drain systems of the resources needed for recovery. In the second, we are examining what factors drive variation in fire severity (2019-20 was noted for particularly devastating high severity fires) so that we can forecast the return times of extreme years such as 2019-20.</p>
<hr>
</section>
<section id="understanding-emerging-hazards" class="level3">
<h3 class="anchored" data-anchor-id="understanding-emerging-hazards">Understanding Emerging Hazards</h3>
<p>Given the crucial role the rise of COVID-19 has played in our lives over the past year, we chose to shift some of our modeling resources to understanding COVID spread globally. The same spatial modeling and machine learning skills, along with fluency in remote sensing products and disease spread that enable us to do ecological forecasting are also well suited for studying COVID spread. Our team has produced three manuscripts exploring global patterns of COVID spread early in the pandemic. The <a href="https://www.pnas.org/content/117/44/27456.abstract">first paper</a> was the first to detect a signal of the negative effects of UV on spread rate, while cautioning that this effect was insufficient to protect against irresponsible human behavior during summer (predictions made in April 2019, which were unfortunately correct). A <a href="https://www.sciencedirect.com/science/article/pii/S0048969720349305">second paper</a> quantified the role of intervention on COVID spread by using remotely sensed N2 emissions to quantify socioeconomic activity (or lack thereof) as a proxy for widespread intervention. A <a href="https://www.medrxiv.org/content/10.1101/2020.09.29.20202416v1">third paper</a> looks at whether virus evolution has contributed significantly to differences in spread in different countries/states across the world. In particular, we have found evidence that spike protein structure from two of the five accepted clades considered has correlated well with higher growth rates.</p>
<hr>
</section>
<section id="quantification-of-future-drought-risk-at-global-scale" class="level3">
<h3 class="anchored" data-anchor-id="quantification-of-future-drought-risk-at-global-scale">Quantification of future drought risk at global scale</h3>
<p>The significance of the impacts of droughts to ecosystems and the fact that climate change is expected to lead to more frequent and more severe droughts, necessitates the development of approaches to derive robust estimates of future changes in drought risk and their associated impacts. We have developed a new methodological framework for estimating drought risk at global scale. The framework is based on the combination of a novel statistical framework for the analysis of extremes with state-of-the-art climate data and projections. This framework allows us to evaluate at global scale how e.g.&nbsp;drought severity is expected to change or what will be the anticipated spatial extent of future droughts. Such information combined with predictive models for a) drought-related hazards such as fires, b) species distribution models or c) vegetation recovery models, can provide critical information for developing effective mitigation procedures.</p>
<p><img src="https://github.com/Bio2Fi/bio2fi.github.io/blob/main/assets/images/Australian_droughts_over_time.jpg?raw=true" align="left" alt="Droughts" width="500" img="" style="padding: 0px 10px 0px 0px;"></p>
<p><em>Left: Projections of area under drought conditions in Australia. Multi-model projections for different emission scenarios and drought severity classes. Source: Araujo et al.&nbsp;“Today’s 100-year droughts in Australia may become the norm by the end of the century.” Environmental Research Letters (under revision).</em></p>
<p><br clear="left"></p>
<hr>
</section>
<section id="global-forest-structure" class="level3">
<h3 class="anchored" data-anchor-id="global-forest-structure">Global Forest Structure</h3>
<p>Forests sequester approximately 30% of annual carbon emissions to the atmosphere, but increasingly lose carbon back to the atmosphere through deforestation and degradation. Forests are a key component of climate change mitigation strategies through the UNFCCC, with large scale forest conservation, reforestation and afforestation included in many national commitments to combat climate change. To date, we have not had an accurate global forest carbon product, largely due to a lack of appropriate satellite data relevant to mapping forests in 3D. NASA’s GEDI mission (launched 2018) has released global-scale forest height, canopy cover and biomass products, enabling the quantification of carbon impacts of forest conservation activities. GEDI data also provide insights into the linkages between forest structure, carbon dynamics, and environmental change (e.g.&nbsp;shifting climate regimes).</p>
<p>This sub-group focuses on using GEDI data to map forest structure at a range of spatial scales, and explore questions related to quantifying forest carbon stocks and fluxes associated with environmental change and forest conservation. GEDI data have enabled the team to map global-scale impacts of global forest conservation activities, such as the avoided carbon emissions associated with protected areas. These results highlight the importance of forest protection for achieving climate targets, particularly for countries with high deforestation rates. GEDI data are also linked to the team’s work in Colorado, California and the Amazon, quantifying the relationships between forest structure and drought. Understanding how climate impacts forest structure and carbon enables the forecasting of ecosystem carbon dynamics in future climate scenarios.</p>
<p><img src="https://github.com/Bio2Fi/bio2fi.github.io/blob/main/assets/images/GEDI_fig_1.jpeg?raw=true" align="left" alt="GEDI 1" width="700" img="" style="padding: 0px 10px 0px 0px;"></p>
<p><br clear="left"></p>
<p><em>Above: Global protected areas are statistically matched to ecologically similar areas, and GEDI data are used to quantify the avoided carbon emissions associated with protected areas.</em></p>
<p><img src="https://github.com/Bio2Fi/bio2fi.github.io/blob/main/assets/images/GEDI_fig_2.png?raw=true" align="left" alt="GEDI 2" width="700" img="" style="padding: 0px 10px 0px 0px;"></p>
<p><br clear="left"></p>
<p><em>Above: GEDI data are used to map forest height and biomass both for the Amazon basin, and at a global scale. These forest structure maps are linked to environmental change such as drought products, which will help understand and forecast potential future changes in forest structure and biomass associated with shifting climate trends.</em></p>
<hr>
</section>
<section id="colorado-climate-change" class="level3">
<h3 class="anchored" data-anchor-id="colorado-climate-change">Colorado Climate Change</h3>
<p>Mountainous watersheds provide 60-90% of water resources worldwide, and have accordingly been referred to as the ‘water towers’ of the world. However, uncertainty associated with predicting watershed hydrobiogeochemical behavior remains high as climate change, extreme weather, wildfire, land-use change, and other disturbances significantly reshape interactions within the world’s watersheds. Recent global-climate-model ensembles predict increased temperature and earlier snowmelt in western North America and reduced spring precipitation and increased late summer monsoon precipitation in the future.</p>
<p>Recent works of this subgroup have focused on understanding and characterizing the heterogeneity (hydrology, geomorphology, and ecological properties) governing mountainous watersheds. We investigated bedrock-through-canopy properties by integrating different sensing technology and identifying environmental factors driving plant communities distributions and dynamics as well as biogeochemical processes.</p>
<p>This subgroup is currently focusing on understanding variation in the flux of water in a headwater catchment of the Colorado River. Such catchments are important for water resources, because they influence hydrology through evapotranspiration (ET) and nutrient cycling. Using data from satellites, airplanes and on-the ground long-term surveys we are harnessing remote sensing data to have a detailed picture of how shifts in biodiversity have impacted watershed function. We have focused on understanding how changing patterns of temperature and drought are driving shifts in composition, diversity and functional trait distributions of the vegetation, and how these climate and vegetation changes have in turn resulted in changes in ET and ecosystem productivity.</p>
<p><img src="https://github.com/Bio2Fi/bio2fi.github.io/blob/main/assets/images/CO_fig_2.png?raw=true" align="left" alt="CO" width="500" img="" style="padding: 0px 10px 0px 0px;"></p>
<p><em>Left: Watershed ecosystem characterization and impact of landscape properties on plant community distribution: a) Map of plant species/communities distribution at 1m scale across the 4 watersheds derived by airborne hyperspectral imagery; b) Insect map showing a portion of an Aspen forest with associated canopy height (CHM) derived by airborne LiDAR data; c) PCA biplot showing the co-varibiality between community distribution and abiotic properties. (Falco et al, in prep).</em></p>
<p><br clear="left"></p>
<hr>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/bio2fi\.github\.io");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This page is built with ❤️ and <a href="https://quarto.org/">Quarto</a>, with theme from <a href="https://github.com/rstudio/vetiver.rstudio.com">vetiver</a></p>
</div>
  </div>
</footer>




</body></html>